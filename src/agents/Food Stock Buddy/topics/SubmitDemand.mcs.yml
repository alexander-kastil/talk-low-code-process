# Name: Submit Demand
kind: AdaptiveDialog
modelDescription: "Collect demand for food to order. Triggered by phrases like: I want to provide my demand, I want to tell you what food I need"
beginDialog:
  kind: OnRecognizedIntent
  id: main
  intent:
    triggerQueries:
      - I want to submit demand
      - I want to plan an order
      - I want to buy food

  actions:
    - kind: AdaptiveCardPrompt
      id: demandCard
      card: |-
        {
          "$schema": "https://adaptivecards.io/schemas/adaptive-card.json",
          "type": "AdaptiveCard",
          "version": "1.5",
          "body": [
            {
              "type": "TextBlock",
              "text": "Please enter your demand",
              "size": "Large",
              "weight": "Bolder",
              "wrap": true,
              "spacing": "Medium"
            },
            {
              "type": "ColumnSet",
              "spacing": "Medium",
              "columns": [
                {
                  "type": "Column",
                  "width": "stretch",
                  "items": [
                    {
                      "type": "TextBlock",
                      "text": "Enter required quantity",
                      "weight": "Bolder",
                      "wrap": true
                    }
                  ]
                },
                {
                  "type": "Column",
                  "width": "auto",
                  "items": [
                    {
                      "type": "TextBlock",
                      "text": "Quantity",
                      "weight": "Bolder",
                      "wrap": true
                    }
                  ]
                }
              ]
            },
              {
              "type": "ColumnSet",
              "spacing": "Small",
              "columns": [
                {
                  "type": "Column",
                  "width": "stretch",
                  "items": [
                    {
                      "type": "TextBlock",
                      "text": "Wiener Schnitzel",
                      "wrap": true
                    }
                  ]
                },
                {
                  "type": "Column",
                  "width": "auto",
                  "verticalContentAlignment": "Center",
                  "items": [
                    {
                      "type": "Input.Number",
                      "id": "qty.WienerSchnitzel",
                      "min": 0,
                      "value": 0
                    }
                  ]
                }
              ]
            },
            {
              "type": "ColumnSet",
              "spacing": "Small",
              "columns": [
                {
                  "type": "Column",
                  "width": "stretch",
                  "items": [
                    {
                      "type": "TextBlock",
                      "text": "Kaiserschmarrn",
                      "wrap": true
                    }
                  ]
                },
                {
                  "type": "Column",
                  "width": "auto",
                  "verticalContentAlignment": "Center",
                  "items": [
                    {
                      "type": "Input.Number",
                      "id": "qty.Kaiserschmarrn",
                      "min": 0,
                      "value": 0
                    }
                  ]
                }
              ]
            },
            {
              "type": "ColumnSet",
              "spacing": "Small",
              "columns": [
                {
                  "type": "Column",
                  "width": "stretch",
                  "items": [
                    {
                      "type": "TextBlock",
                      "text": "Germkn√∂del",
                      "wrap": true
                    }
                  ]
                },
                {
                  "type": "Column",
                  "width": "auto",
                  "verticalContentAlignment": "Center",
                  "items": [
                    {
                      "type": "Input.Number",
                      "id": "qty.Germknoedel",
                      "min": 0,
                      "value": 0
                    }
                  ]
                }
              ]
            },
            {
              "type": "ColumnSet",
              "spacing": "Small",
              "columns": [
                {
                  "type": "Column",
                  "width": "stretch",
                  "items": [
                    {
                      "type": "TextBlock",
                      "text": "Weisswurst mit Brezn",
                      "wrap": true
                    }
                  ]
                },
                {
                  "type": "Column",
                  "width": "auto",
                  "verticalContentAlignment": "Center",
                  "items": [
                    {
                      "type": "Input.Number",
                      "id": "qty.WeisswurstMitBrezn",
                      "min": 0,
                      "value": 0
                    }
                  ]
                }
              ]
            },
              {
              "type": "ColumnSet",
              "spacing": "Small",
              "columns": [
                {
                  "type": "Column",
                  "width": "stretch",
                  "items": [
                    {
                      "type": "TextBlock",
                      "text": "Schweinshaxe mit Kraut",
                      "wrap": true
                    }
                  ]
                },
                {
                  "type": "Column",
                  "width": "auto",
                  "verticalContentAlignment": "Center",
                  "items": [
                    {
                      "type": "Input.Number",
                      "id": "qty.SchweinshaxeMitKraut",
                      "min": 0,
                      "value": 0
                    }
                  ]
                }
              ]
            },          
            {
              "type": "ColumnSet",
              "spacing": "Small",
              "columns": [
                {
                  "type": "Column",
                  "width": "stretch",
                  "items": [
                    {
                      "type": "TextBlock",
                      "text": "Pizza Napoli",
                      "wrap": true
                    }
                  ]
                },
                {
                  "type": "Column",
                  "width": "auto",
                  "verticalContentAlignment": "Center",
                  "items": [
                    {
                      "type": "Input.Number",
                      "id": "qty.PizzaNapoli",
                      "min": 0,
                      "value": 0
                    }
                  ]
                }
              ]
            },            
            {
              "type": "ColumnSet",
              "spacing": "Small",
              "columns": [
                {
                  "type": "Column",
                  "width": "stretch",
                  "items": [
                    {
                      "type": "TextBlock",
                      "text": "Arancini Napoletana",
                      "wrap": true
                    }
                  ]
                },
                {
                  "type": "Column",
                  "width": "auto",
                  "verticalContentAlignment": "Center",
                  "items": [
                    {
                      "type": "Input.Number",
                      "id": "qty.AranciniNapoletana",
                      "min": 0,
                      "value": 0
                    }
                  ]
                }
              ]
            },          
            {
              "type": "ColumnSet",
              "spacing": "Small",
              "columns": [
                {
                  "type": "Column",
                  "width": "stretch",
                  "items": [
                    {
                      "type": "TextBlock",
                      "text": "Pad Ka Prao",
                      "wrap": true
                    }
                  ]
                },
                {
                  "type": "Column",
                  "width": "auto",
                  "verticalContentAlignment": "Center",
                  "items": [
                    {
                      "type": "Input.Number",
                      "id": "qty.PadKaPrao",
                      "min": 0,
                      "value": 0
                    }
                  ]
                }
              ]
            },
            {
              "type": "ColumnSet",
              "spacing": "Small",
              "columns": [
                {
                  "type": "Column",
                  "width": "stretch",
                  "items": [
                    {
                      "type": "TextBlock",
                      "text": "Green Curry",
                      "wrap": true
                    }
                  ]
                },
                {
                  "type": "Column",
                  "width": "auto",
                  "verticalContentAlignment": "Center",
                  "items": [
                    {
                      "type": "Input.Number",
                      "id": "qty.GreenCurry",
                      "min": 0,
                      "value": 0
                    }
                  ]
                }
              ]
            }
          ],
          "actions": [
            {
              "type": "Action.Submit",
              "title": "Submit Demand"
            }
          ]
        }
      output:
        binding:
          qty.AranciniNapoletana: Topic.qtyAranciniNapoletana
          qty.Germknoedel: Topic.qtyGermknoedel
          qty.GreenCurry: Topic.qtyGreenCurry
          qty.Kaiserschmarrn: Topic.qtyKaiserschmarrn
          qty.PadKaPrao: Topic.qtyPadKaPrao
          qty.PizzaNapoli: Topic.qtyPizzaNapoli
          qty.SchweinshaxeMitKraut: Topic.qtySchweinshaxeMitKraut
          qty.WeisswurstMitBrezn: Topic.qtyWeisswurstMitBrezn
          qty.WienerSchnitzel: Topic.qtyWienerSchnitzel

      outputType:
        properties:
          qty.AranciniNapoletana: Number
          qty.Germknoedel: Number
          qty.GreenCurry: Number
          qty.Kaiserschmarrn: Number
          qty.PadKaPrao: Number
          qty.PizzaNapoli: Number
          qty.SchweinshaxeMitKraut: Number
          qty.WeisswurstMitBrezn: Number
          qty.WienerSchnitzel: Number

    - kind: SetVariable
      id: setVariable_eIf7DZ
      variable: Global.orderDemand
      value: |-
        =JSON({
              Kaiserschmarrn: Topic.qtyKaiserschmarrn,
              WeisswurstMitBrezn: Topic.qtyWeisswurstMitBrezn,
              WienerSchnitzel: Topic.qtyWienerSchnitzel,
              PizzaNapoli: Topic.qtyPizzaNapoli,
              Germknoedel: Topic.qtyGermknoedel,
              AranciniNapoletana: Topic.qtyAranciniNapoletana,
              SchweinshaxeMitKraut: Topic.qtySchweinshaxeMitKraut,
              PadKaPrao: Topic.qtyPadKaPrao,
              GreenCurry: Topic.qtyGreenCurry
        })

    - kind: SetVariable
      id: setOutput
      variable: Topic.orderDemandClean
      value: "=JSON(Filter(Table({Name: \"Kaiserschmarrn\", Quantity: Topic.qtyKaiserschmarrn}, {Name: \"WeisswurstMitBrezn\", Quantity: Topic.qtyWeisswurstMitBrezn}, {Name: \"WienerSchnitzel\", Quantity: Topic.qtyWienerSchnitzel}, {Name: \"PizzaNapoli\", Quantity: Topic.qtyPizzaNapoli}, {Name: \"Germknoedel\", Quantity: Topic.qtyGermknoedel}, {Name: \"AranciniNapoletana\", Quantity: Topic.qtyAranciniNapoletana}, {Name: \"SchweinshaxeMitKraut\", Quantity: Topic.qtySchweinshaxeMitKraut}, {Name: \"PadKaPrao\", Quantity: Topic.qtyPadKaPrao}, {Name: \"GreenCurry\", Quantity: Topic.qtyGreenCurry}), Quantity > 0), JSONFormat.Compact)"

    - kind: SendActivity
      id: sendActivity_MnOZNi
      activity:
        value: =Topic.orderDemandClean
        text:
          - "Your demand was successfully noted:{Topic.orderDemandClean}"

inputType: {}
outputType: {}