# Name: Submit Refund Request
kind: AdaptiveDialog
modelDescription: The user want to submit a travel expense claim
beginDialog:
  kind: OnRecognizedIntent
  id: main
  intent: {}
  actions:
    - kind: AdaptiveCardPrompt
      id: 1iIn8r
      displayName: Get refund metadata
      card: |-
        {
          "$schema": "https://adaptivecards.io/schemas/adaptive-card.json",
          "type": "AdaptiveCard",
          "version": "1.5",
          "body": [
            {
              "type": "TextBlock",
              "text": "Expense Claim",
              "weight": "Bolder",
              "size": "Medium"
            },
            {
              "type": "Input.Text",
              "id": "email",
              "label": "Email Address",
              "placeholder": "Your email (auto-filled from system)",
              "isRequired": true,
              "errorMessage": "Please enter your email"
            },
            {
              "type": "Input.Text",
              "id": "destination",
              "label": "Destination",
              "placeholder": "Enter destination",
              "isRequired": true,
              "errorMessage": "Please enter the destination"
            },
            {
              "type": "Input.Date",
              "id": "departureDate",
              "label": "Departure Date",
              "isRequired": true,
              "errorMessage": "Please enter departure date"
            },
            {
              "type": "Input.Date",
              "id": "returnDate",
              "label": "Return Date",
              "isRequired": true,
              "errorMessage": "Please enter return date"
            },
            {
              "type": "Input.Number",
              "id": "amount",
              "label": "Amount",
              "placeholder": "Enter amount",
              "isRequired": true,
              "errorMessage": "Please enter the amount claimed"
            },
            {
              "type": "Input.Text",
              "id": "comment",
              "label": "Comment",
              "placeholder": "Enter any comments",
              "isMultiline": true
            }
          ],
          "actions": [
            {
              "type": "Action.Submit",
              "title": "Submit Claim"
            }
          ]
        }
      output:
        binding:
          actionSubmitId: Topic.actionSubmitId
          amount: Topic.amount
          comment: Topic.comment
          departureDate: Topic.departureDate
          destination: Topic.destination
          email: Topic.email
          returnDate: Topic.returnDate

      outputType:
        properties:
          actionSubmitId: String
          amount: Number
          comment: String
          departureDate: String
          destination: String
          email: String
          returnDate: String

    - kind: SetVariable
      id: setVariable_sIr86k
      variable: Topic.expenseClaim
      value: =Topic

    - kind: SetVariable
      id: normalizeDepartureIso
      variable: Topic.departureDateIso
      value: =Topic.departureDate & "T00:00:00Z"

    - kind: SetVariable
      id: normalizeReturnIso
      variable: Topic.returnDateIso
      value: =Topic.returnDate & "T00:00:00Z"

    - kind: SetVariable
      id: setVariable_VXHZ8x
      variable: Topic.claimID
      value: =Text(GUID())

    - kind: InvokeFlowAction
      id: invokeFlowAction_9yzo79
      input:
        binding:
          number: =Topic.amount
          text: =Topic.claimID
          text_1: =Topic.email
          text_2: =Topic.destination
          text_3: =Topic.comment
          text_4: =Topic.departureDate
          text_5: =Topic.returnDate

      output: {}
      flowId: 722883f1-62b3-f011-bbd2-7c1e52278fc9

inputType: {}
outputType: {}